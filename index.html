<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Experimental station-based bicycle sharing planner • sbplanr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Experimental station-based bicycle sharing planner">
<meta property="og:description" content="Tool for placing bicycle sharing stations by iteratively minimizing
    a global energy of a model that reflects the station-based bicycle sharing
    system. The station locations are randomly initialized in the street network
    and iteratively optimized based on the reachable population in combination
    with walking and driving times.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sbplanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/run-model.html">Example model run</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/munterfi/sbplanr" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/munterfi1" class="external-link">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://munterfinger.ch" class="external-link">
    <span class="fa fa-globe fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="station-based-bicycle-sharing-planner-">Station-based bicycle sharing planner
<img src="reference/figures/logo.svg" align="right" alt="" width="120"><a class="anchor" aria-label="anchor" href="#station-based-bicycle-sharing-planner-"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>Tool for placing bicycle sharing stations by iteratively minimizing a
global energy of a model that reflects the station-based bicycle sharing
system. The station locations are randomly initialized in the street
network and iteratively optimized based on the reachable population in
combination with walking and driving times. Initially forked from <a href="https://github.com/munterfi/drtplanr" class="external-link">munterfi/drtplanr</a>.</p>
<p>The model in the package example optimizes the positions of stations
in an assumed bicycle sharing service for the municipality Bülach in
Zurich, Switzerland.</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th><img src="https://github.com/munterfi/sbplanr/blob/master/docs/example_i1000_energy_plot.png"></th>
<th><img src="https://github.com/munterfi/sbplanr/blob/master/docs/example_i1000_station_map.png"></th>
</tr></thead>
<tbody></tbody>
</table>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>Install the development version from <a href="https://github.com/munterfi/sbplanr/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"munterfi/sbplanr"</span><span class="op">)</span></code></pre></div>
<p>Create an example model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example data</span>
<span class="va">aoi</span> <span class="op">&lt;-</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example.gpkg"</span>, package <span class="op">=</span> <span class="st">"sbplanr"</span><span class="op">)</span>, layer <span class="op">=</span> <span class="st">"aoi"</span><span class="op">)</span>

<span class="va">pop</span> <span class="op">&lt;-</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example.gpkg"</span>, package <span class="op">=</span> <span class="st">"sbplanr"</span><span class="op">)</span>, layer <span class="op">=</span> <span class="st">"pop"</span><span class="op">)</span>

<span class="va">poi</span> <span class="op">&lt;-</span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example.gpkg"</span>, package <span class="op">=</span> <span class="st">"sbplanr"</span><span class="op">)</span>, layer <span class="op">=</span> <span class="st">"poi"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>

<span class="co"># Create model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sb_sbm.html">sb_sbm</a></span><span class="op">(</span>
  model_name <span class="op">=</span> <span class="st">"Buelach"</span>,
  aoi <span class="op">=</span> <span class="va">aoi</span>, pop <span class="op">=</span> <span class="va">pop</span>, poi <span class="op">=</span> <span class="va">poi</span>,
  n_sta <span class="op">=</span> <span class="fl">15</span>, m_seg <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span>

<span class="co"># Iterate the model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sb_iterate.html">sb_iterate</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">100</span><span class="op">)</span>

<span class="co"># Visualize results</span>
<span class="fu"><a href="reference/sb_plot.html">sb_plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="fu"><a href="reference/sb_map.html">sb_map</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="structure-of-the-model">Structure of the model<a class="anchor" aria-label="anchor" href="#structure-of-the-model"></a>
</h2>
<div class="section level3">
<h3 id="input-layers">Input layers<a class="anchor" aria-label="anchor" href="#input-layers"></a>
</h3>
<p>The model is set up with the following inputs:</p>
<ul>
<li>
<strong>Spatial layer</strong>:
<ul>
<li>Area of Interest (POLYGON).</li>
<li>Population raster centroids (POINT).</li>
<li>Point(s) of Interest (POINT).</li>
</ul>
</li>
<li>
<strong>Parameters</strong>:
<ul>
<li>A model name.</li>
<li>Distance in meters to segment the street network for candidate
creation: default = 100m (The value is equivalent to the minimum
possible distance between two stations on the street network).</li>
<li>Number of stations to place.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="global-energy">Global energy<a class="anchor" aria-label="anchor" href="#global-energy"></a>
</h3>
<p>Function that calculates the global energy of the current model
state. The aim is to place the station in a way, that the residents and
workers around them have to walk as short as possible to the station and
that the station is connected as well as possible to other attractive
stations in the network. An attractive station is a station with many
people in the catchment area that can be quickly reached by bicycle.</p>
<p><img src="https://render.githubusercontent.com/render/math?math=Eg%20=%20%5Csum_%7Bs_1%20%5Cneq%20s_2%7D%20%5Csum_%7Bc%20%5Cin%20S_1%7D%20%5Csum_%7Bd%20%5Cin%20S_2%7D%20P_c%20*%20P_d%20*%20(Wt_%7Bc%7D%20+%20Bt_%7Bs1s2%7D%20+%20Wt_d)"></p>
<p>When the direct walking time between to populations is faster than
the travel using the bicycle (walk to station, cycle, walk from
station), than the direct walking travel is chosen.</p>
</div>
<div class="section level3">
<h3 id="optimization">Optimization<a class="anchor" aria-label="anchor" href="#optimization"></a>
</h3>
<p>The global energy of the model is optimized in iterations. In every
iteration one station is randomly selected and moved to another position
on the segmented street network. The global energy of the model state
with the new candidate is calculated. If the global energy is lower as
befor, the candidate is accepted and the next iteration starts. If the
global energy is higher, the candidate is rejected with the probability
<span class="math inline">1 − <em>α</em></span>. The probability <span class="math inline"><em>α</em></span> decreases exponentially as a
function of the number of iterations (<span class="math inline"><em>i</em></span>):</p>
<p><img src="https://render.githubusercontent.com/render/math?math=f(i)%20=%20%5Cfrac%7B1%7D%7B(i%20+%201)%7D"></p>
<p>The concept of sometimes allowing a bad candidate to be accepted is
known as annealing. This technique prevents the optimization from being
captured in a local minimum before the global minimum is reached.</p>
</div>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<ul>
<li>Merlin Unterfinger (inital idea, package implementation) - <a href="https://github.com/munterfi" class="external-link">munterfi</a>
</li>
<li>Thomas Hettinger (energy definition) - <a href="https://github.com/thetti" class="external-link">thetti</a>
</li>
<li>David Masson (ideas and feedback on model optimization, annealing) -
<a href="https://github.com/panhypersebastos" class="external-link">panhypersebastos</a>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Initially forked from <a href="https://github.com/munterfi/drtplanr" class="external-link">munterfi/drtplanr</a>
</li>
<li>
<a href="https://github.com/munterfi/hereR" class="external-link">hereR</a>: R interface
to the HERE REST APIs</li>
<li>
<a href="https://www.bfs.admin.ch/" class="external-link">BfS</a>: Population data for
Switzerland</li>
<li>
<a href="https://www.openstreetmap.org/" class="external-link">OSM</a>: Street network
data for routing purposes.</li>
</ul>
</div>
<div class="section level2">
<h2 id="licence">Licence<a class="anchor" aria-label="anchor" href="#licence"></a>
</h2>
<ul>
<li>This repository is licensed under the GNU General Public License
v3.0 - see the <a href="LICENSE.html">LICENSE.md</a> file for
details.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/munterfi/sbplanr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/munterfi/sbplanr/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sbplanr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.munterfinger.ch" class="external-link">Merlin Unterfinger</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2020-2366" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/munterfi/sbplanr/actions" class="external-link"><img src="https://github.com/munterfi/sbplanr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/munterfi/sbplanr/actions" class="external-link"><img src="https://github.com/munterfi/sbplanr/workflows/pkgdown/badge.svg" alt="pkgdown"></a></li>
<li><a href="https://codecov.io/gh/munterfi/sbplanr?branch=master" class="external-link"><img src="https://codecov.io/gh/munterfi/sbplanr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.munterfinger.ch" class="external-link">Merlin
Unterfinger</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
